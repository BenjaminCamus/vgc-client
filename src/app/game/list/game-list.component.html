<div id="gameBanner" class="gameBannerBig">
    <div *ngIf="userGames && userGames[0] && userGames[0].game.screenshots"
         [style.background-image]="'url(http://images.igdb.com/igdb/image/upload/t_screenshot_huge/' + userGames[0].game.screenshots[0].cloudinaryId + '.jpg)' | safe: 'style'"></div>
</div>

<div class="filters" [ngClass]="displayFilters ? 'on' : ''" style="padding-bottom: 15px">
    <div class="row">
        <div class="col-md-3">
            <label for="name">Platforme</label><br>
            <tag *ngFor="let platform of platformTags;"
                 [tag]="platform.name"
                 [suffix]="platformCount[platform.id]"
                 (uploaded)="toggleTag('platform', $event, platform)"></tag>
            <label for="name">Développeur</label><br>
            <tag *ngFor="let developer of developerTags;"
                 [tag]="developer.name"
                 [suffix]="developerCount[developer.id]"
                 (uploaded)="toggleTag('developer', $event, developer)"></tag>
            <label for="name">Éditeur</label><br>
            <tag *ngFor="let publisher of publisherTags;"
                 [tag]="publisher.name"
                 [suffix]="publisherCount[publisher.id]"
                 (uploaded)="toggleTag('publisher', $event, publisher)"></tag>
        </div>
        <div class="col-md-3">
            <label for="name">Note ({{userGameFilter.ratingRange[0] + ' - ' + userGameFilter.ratingRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.ratingRange" [range]="true" [min]="userGameFilter.minRating" [max]="userGameFilter.maxRating"></p-slider>

            <label for="name">Prix Payé ({{userGameFilter.pricePaidRange[0] + ' - ' + userGameFilter.pricePaidRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.pricePaidRange" [range]="true" [min]="userGameFilter.minPrice" [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Revente ({{userGameFilter.priceResaleRange[0] + ' - ' + userGameFilter.priceResaleRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceResaleRange" [range]="true" [min]="userGameFilter.minPrice" [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Vendu ({{userGameFilter.priceSoldRange[0] + ' - ' + userGameFilter.priceSoldRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceSoldRange" [range]="true" [min]="userGameFilter.minPrice" [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Demandé ({{userGameFilter.priceAskedRange[0] + ' - ' + userGameFilter.priceAskedRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceAskedRange" [range]="true" [min]="userGameFilter.minPrice" [max]="userGameFilter.maxPrice"></p-slider>
        </div>
        <div class="col-md-3">
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <h1>
                Mes Jeux<!--
                --><i class="hovicon fa fa-refresh" (click)="getGames()" [ngClass]="loading ? 'fa-spin' : ''"></i><!--
                --><i class="hovicon fa fa-search" (click)="displayFilters = !displayFilters"></i><!--
                --><div style="width: 400px; position: absolute; margin: 12px; display: inline-block;">
                    <input type="text" id="name" name="name"
                           [(ngModel)]="userGameFilter.game.name"
                           #name="ngModel"
                           autocomplete="off">
                    <span class="bar"></span>
                </div>
            </h1>
        </div>
    </div>

    <div class="row" *ngIf="loading">
        <div class="col-md-12">
            Synchronisation en cours...
        </div>
    </div>
</div>

<div class="row" *ngIf="!loading">
    <div class="col-md-12">

        <!--<p-dataTable [value]="userGames | filter: userGameFilter">-->
            <!--<p-column field="platform.name" header="Plateforme" [sortable]="true"></p-column>-->
            <!--<p-column field="game.name" header="Titre" [sortable]="true"></p-column>-->
            <!--<p-column field="purchaseDate | date: 'dd/MM/y'" header="Date Achat" [sortable]="true"></p-column>-->
        <!--</p-dataTable>-->

        <section *ngFor="let userGame of userGames | filter: userGameFilter;"
                 routerLink="/game/{{userGame.platform.slug}}/{{userGame.game.slug}}"
                 class="gameBox visible_anim" in-viewport (inViewport)="setItemClass($event)">
            <div class="gameCover" *ngIf="userGame.game.cover"
                 [style.background-image]="'url(http://images.igdb.com/igdb/image/upload/t_cover_big/' + userGame.game.cover.cloudinaryId + '.jpg)' | safe: 'style'"></div>
            <div class=gameInfos>
                <div class="gameTitle">
                    {{ userGame.game.name }}
                </div>

                <div class="row">
                    <div class="col-md-12">
                        {{ userGame.platform.name }}
                        <br>
                        <span *ngIf="userGame.game.developers[0]">{{ userGame.game.developers[0].name }}</span>
                        <br>
                        {{ userGame.version }}
                        <span *ngIf="userGame.box && userGame.manual">Complet</span>
                        <span *ngIf="userGame.box && !userGame.manual">Boîte sans livret</span>
                        <span *ngIf="!userGame.box && userGame.manual">Livret sans boîte</span>
                        <span *ngIf="!userGame.box && !userGame.manual">Loose</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        Demandé {{ userGame.priceAsked }}€
                    </div>
                    <div class="col-md-6">
                        Payé {{ userGame.pricePaid }}€
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        Revente {{ userGame.priceResale }}€
                    </div>
                    <div class="col-md-6">
                        Vendu {{ userGame.priceSold }}€
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>