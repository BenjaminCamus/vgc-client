<div id="gameBanner" class="gameBannerBig">
    <section *ngFor="let userGame of userGames | filter: userGameFilter | orderBy: orderField:orderOption;
     let i = index;">
        <div *ngIf="i == 0 && userGame.game.screenshots && userGame.game.screenshots.length > 0"
             [style.background-image]="'url(http://images.igdb.com/igdb/image/upload/t_screenshot_huge/' + userGame.game.screenshots[0].cloudinaryId + '.jpg)' | safe: 'style'"></div>
        <div *ngIf="i == 0 && (!userGame.game.screenshots || userGame.game.screenshots.length == 0)"></div>

    </section>
</div>

<div class="filters" *ngIf="displayFilters" [ngClass]="displayFilters ? 'on' : ''" style="padding-bottom: 15px">
    <div class="row">
        <div class="col-md-3">
            <div>
                <label for="name">Platforme</label><br>
                <tag *ngFor="let platform of platformTags;"
                     [tag]="platform.name"
                     [suffix]="platformCount[platform.id]"
                     (uploaded)="toggleTag('platforms', $event, platform)"></tag>
            </div>
            <div>
                <label>Version</label><br>
                <tag [tag]="'FRA'" (uploaded)="toggleTag('versions', $event, 'FRA')"></tag>
                <tag [tag]="'EUR'" (uploaded)="toggleTag('versions', $event, 'EUR')"></tag>
                <tag [tag]="'FAH'" (uploaded)="toggleTag('versions', $event, 'FAH')"></tag>
            </div>
            <div>
                <label>Progression</label><br>
                <tag [tag]="'Jamais joué'" (uploaded)="toggleTag('progresses', $event, 0)"></tag>
                <tag [tag]="'En cours'" (uploaded)="toggleTag('progresses', $event, 1)"></tag>
                <tag [tag]="'Terminé'" (uploaded)="toggleTag('progresses', $event, 2)"></tag>
                <tag [tag]="'Abandonné'" (uploaded)="toggleTag('progresses', $event, 3)"></tag>
            </div>
        </div>
        <div class="col-md-3">
            <label for="name">Note ({{userGameFilter.ratingRange[0] + ' - ' +
                userGameFilter.ratingRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.ratingRange" [range]="true" [min]="userGameFilter.minRating"
                      [max]="userGameFilter.maxRating"></p-slider>

            <label for="name">Prix Payé ({{userGameFilter.pricePaidRange[0] + ' - ' +
                userGameFilter.pricePaidRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.pricePaidRange" [range]="true" [min]="userGameFilter.minPrice"
                      [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Revente ({{userGameFilter.priceResaleRange[0] + ' - ' +
                userGameFilter.priceResaleRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceResaleRange" [range]="true" [min]="userGameFilter.minPrice"
                      [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Vendu ({{userGameFilter.priceSoldRange[0] + ' - ' +
                userGameFilter.priceSoldRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceSoldRange" [range]="true" [min]="userGameFilter.minPrice"
                      [max]="userGameFilter.maxPrice"></p-slider>

            <label for="name">Prix Demandé ({{userGameFilter.priceAskedRange[0] + ' - ' +
                userGameFilter.priceAskedRange[1]}})</label><br>
            <p-slider [(ngModel)]="userGameFilter.priceAskedRange" [range]="true" [min]="userGameFilter.minPrice"
                      [max]="userGameFilter.maxPrice"></p-slider>
        </div>
        <div class="col-md-3">
            <label for="name">Lieu Achat</label><br>
            <tag *ngFor="let place of purchasePlaceTags;"
                 [tag]="place.name"
                 [suffix]="purchasePlaceCount[place.id]"
                 (uploaded)="toggleTag('purchasePlaces', $event, place)"></tag>
            <br>
            <label for="name">Contact Achat</label><br>
            <tag *ngFor="let contact of purchaseContactTags;"
                 [tag]="contact | formatName"
                 [suffix]="purchaseContactCount[contact.id]"
                 (uploaded)="toggleTag('purchaseContacts', $event, contact)"></tag>
        </div>
        <div class="col-md-3">
            <label for="name">Lieu Vente</label><br>
            <tag *ngFor="let place of salePlaceTags;"
                 [tag]="place.name"
                 [suffix]="salePlaceCount[place.id]"
                 (uploaded)="toggleTag('salePlaces', $event, place)"></tag>
            <br>
            <label for="name">Contact Vente</label><br>
            <tag *ngFor="let contact of saleContactTags;"
                 [tag]="contact | formatName"
                 [suffix]="saleContactCount[contact.id]"
                 (uploaded)="toggleTag('saleContacts', $event, contact)"></tag>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <label for="name">Développeur</label><br>
            <tag *ngFor="let developer of developerTags;"
                 [tag]="developer.name"
                 [suffix]="developerCount[developer.id]"
                 (uploaded)="toggleTag('developer', $event, developer)"></tag>
            <br>
            <label for="name">Éditeur</label><br>
            <tag *ngFor="let publisher of publisherTags;"
                 [tag]="publisher.name"
                 [suffix]="publisherCount[publisher.id]"
                 (uploaded)="toggleTag('publisher', $event, publisher)"></tag>
            <br>
            <label for="name">Mode</label><br>
            <tag *ngFor="let mode of modeTags;"
                 [tag]="mode.name"
                 [suffix]="modeCount[mode.id]"
                 (uploaded)="toggleTag('mode', $event, mode)"></tag>
            <br>
            <label for="name">Thème</label><br>
            <tag *ngFor="let theme of themeTags;"
                 [tag]="theme.name"
                 [suffix]="themeCount[theme.id]"
                 (uploaded)="toggleTag('theme', $event, theme)"></tag>
            <br>
            <label for="name">Genre</label><br>
            <tag *ngFor="let genre of genreTags;"
                 [tag]="genre.name"
                 [suffix]="genreCount[genre.id]"
                 (uploaded)="toggleTag('genre', $event, genre)"></tag>
        </div>
    </div>
</div>


<div class="title">
    Mes Jeux
    <i class="hovicon fa fa-refresh" (click)="getGames()"
          [ngClass]="slimLoadingBarService.progress > 0 ? 'fa-spin' : ''"></i><!--
    --><i *ngIf="displayMode != 0" (click)="displayMode = 0" class="hovicon fa fa-th"></i><!--
    --><i *ngIf="displayMode != 1" (click)="displayMode = 1" class="hovicon fa fa-bars"></i><!--
    --><i class="hovicon fa fa-search" (click)="displayFilters = !displayFilters"></i>

    <div class="input">
        <input type="text" id="name" name="name"
               [(ngModel)]="userGameFilter.game.name"
               #name="ngModel"
               autocomplete="off"
               placeholder="Recherche">
        <span class="bar"></span>
    </div>
    <div class="input">
        <label for="orderField" style="font-size: 14px; margin: 0">Tri</label>
        <div style="width: 200px; display: inline-block; vertical-align: middle;">
            <select id="orderField"
                    required
                    [(ngModel)]="orderField" name="orderField"
                    #name="ngModel">
                <option *ngFor="let field of userGameFields"
                        [value]="field.name">

                    {{ field.label }}
                    <i class="fa" *ngIf="orderField == field.name"
                       [ngClass]="orderOption ? 'fa-sort-asc' : 'fa-sort-desc'"></i>
                    <i class="fa fa-sort-asc" style="visibility: hidden" *ngIf="orderField != field.name"></i>
                </option>
            </select>
        </div>
        <i class="hovicon fa" (click)="orderOption = !orderOption"
           [ngClass]="orderOption ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'"></i>
    </div>
</div>

<div class="row">
    <div class="col-md-12" *ngIf="displayMode == 1">

        <table class="table">
            <tr>
                <th></th>
                <th *ngFor="let field of userGameFields"
                    (click)="setOrderField(field.name)"
                    [ngClass]="field.hiddenMD ? 'hidden-md hidden-sm hidden-xs' : ''">

                    {{ field.label }}
                    <i class="fa" *ngIf="orderField == field.name"
                       [ngClass]="orderOption ? 'fa-sort-asc' : 'fa-sort-desc'"></i>
                    <i class="fa fa-sort-asc" style="visibility: hidden" *ngIf="orderField != field.name"></i>
                </th>
            </tr>
            <tr *ngFor="let userGame of userGames | filter: userGameFilter | orderBy: orderField:orderOption;"
                routerLink="/game/{{userGame.platform.slug}}/{{userGame.game.slug}}">

                <td [style.background-image]="'url(http://images.igdb.com/igdb/image/upload/t_cover_big/' + userGame.game.cover.cloudinaryId + '.jpg)' | safe: 'style'"></td>

                <td *ngFor="let field of userGameFields"
                    [ngClass]="field.hiddenMD ? 'hidden-md hidden-sm hidden-xs' : ''">

                    {{ userGameValues[userGame.game.id][userGame.platform.id][field.name] }}
                </td>
            </tr>
        </table>
    </div>
    <div class="col-md-12" *ngIf="displayMode == 0">

        <section *ngFor="let userGame of userGames | filter: userGameFilter | orderBy: orderField:orderOption;"
                 routerLink="/game/{{userGame.platform.slug}}/{{userGame.game.slug}}"
                 class="gameBox visible_anim" in-viewport (inViewport)="setItemClass($event)">
            <div class="gameCover" *ngIf="userGame.game.cover"
                 [style.background-image]="'url(http://images.igdb.com/igdb/image/upload/t_cover_big/' + userGame.game.cover.cloudinaryId + '.jpg)' | safe: 'style'"></div>
            <div class=gameInfos>
                <div class="gameTitle">
                    {{ userGame.game.name }}
                </div>

                <div class="row">
                    <div class="col-md-12">
                        {{ userGame.platform.name }}
                        <br>
                        <span *ngIf="userGame.game.developers[0]">{{ userGame.game.developers[0].name }}</span>
                        <br>
                        {{ userGame.version }}
                        <span *ngIf="userGame.box && userGame.manual">Complet</span>
                        <span *ngIf="userGame.box && !userGame.manual">Boîte sans livret</span>
                        <span *ngIf="!userGame.box && userGame.manual">Livret sans boîte</span>
                        <span *ngIf="!userGame.box && !userGame.manual">Loose</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        Demandé {{ userGame.priceAsked }}€
                    </div>
                    <div class="col-md-6">
                        Payé {{ userGame.pricePaid }}€
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        Revente {{ userGame.priceResale }}€
                    </div>
                    <div class="col-md-6">
                        Vendu {{ userGame.priceSold }}€
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>